<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Praktikum 1 Avaandmed ja repositooriumid 2 | 09-avaandmed2.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Praktikum 1 Avaandmed ja repositooriumid 2 | 09-avaandmed2.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Praktikum 1 Avaandmed ja repositooriumid 2 | 09-avaandmed2.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path=""><a href="#avaandmed2"><i class="fa fa-check"></i><b>1</b> Avaandmed ja repositooriumid 2</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#andmestike-ühendamine"><i class="fa fa-check"></i><b>1.1</b> Andmestike ühendamine</a><ul>
<li class="chapter" data-level="1.1.1" data-path=""><a href="#csv-info-ühendamine-shp-ga"><i class="fa fa-check"></i><b>1.1.1</b> CSV info ühendamine SHP-ga</a></li>
<li class="chapter" data-level="1.1.2" data-path=""><a href="#shp-info-ühendamine-csv-ga"><i class="fa fa-check"></i><b>1.1.2</b> SHP info ühendamine CSV-ga</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#geokodeerimine"><i class="fa fa-check"></i><b>1.2</b> Geokodeerimine</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#ruumiandmete-käsitsi-lisamine"><i class="fa fa-check"></i><b>1.3</b> Ruumiandmete käsitsi lisamine</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#järgmisel-korral"><i class="fa fa-check"></i><b>1.4</b> Järgmisel korral</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="avaandmed2" class="section level1">
<h1><span class="header-section-number">Praktikum 1</span> Avaandmed ja repositooriumid 2</h1>
<!-- Andmestikud:
- vallakohtuprotokollide andmestik + Maa-ameti haldusjaotuse shapefile'id
- geokodeeritud Album Academicumi andmestik (parandamata)
- geokodeeritud Album Academicumi andmestik (parandatud)
- vallakohtuprotokollide kohanimede andmeid + ajalooline aluskaart
-->
<div id="andmestike-ühendamine" class="section level2">
<h2><span class="header-section-number">1.1</span> Andmestike ühendamine</h2>
<p>Kui meil on olemas andmestik, milles ruumilist infot väljendavad ainult mingid tekstilised tunnused (nt riikide, maakondade, linnade, talude vm nimed), saame nende konkreetsete asukohtade määramiseks, kaardil kuvamiseks ning ruumiliseks analüüsimiseks kasutada ära vabalt kättesaadavaid ruumiandmeid (nt Maa-ameti ruumiandmeid).</p>
<p>Vaatame esmalt varasemast oluliselt suuremat 19. sajandi vallakohtute andmestikku. See on osa <a href="www.ra.ee/vallakohtud">Rahvusarhiivi ühisloomeprojektist</a>, mille käigus on praeguseks sisestatud üle 40 000 vallakohtuprotokolli, kus arutatakse muuhulgas näiteks laenusid ja võlanõudeid, varavastaseid kuritegusid, pärimisasju, kahjutasunõudeid, aga ka näiteks sõimu ja vägivalda ning muid üleastumisi. Siin praktikumis kasutatavas andmestikus on umbes 25 000 protokolli andmed.</p>
<p>Tabel näeb välja selline:</p>
<pre><code>##    id year month day protocol_number
## 1 399 1885     7  19             159
## 2 182 1823     5  19            NULL
## 3 508 1856     2  17               4
## 4 249 1869     3  11              66
## 5 533 1843     3  27            NULL
## 6 583 1899     7   2               2
##                                                                                                   X_record_type  maakond
## 1                     Maade ja hoonete rentimine, mõõtmine ja pärandamine. Ehitamine. Suhted mõisa ja kroonuga.    Pärnu
## 2                                                                                                          NULL Viljandi
## 3                                                                                                          NULL    Tartu
## 4                                                                                          Laenud ja võlanõuded Viljandi
## 5                                                                                    Perekonna- ja pärimisasjad Viljandi
## 6 Varalised tehingud; Maade ja hoonete rentimine, mõõtmine ja pärandamine. Ehitamine. Suhted mõisa ja kroonuga.    Harju
##   kihelkond      vald number_of_characters
## 1  Halliste    Penuja                  409
## 2     Helme      Lõve                   84
## 3  Kodavere Alatskivi                  211
## 4     Helme      Lõve                   60
## 5    Paistu   Holstre                  348
## 6      Kose   Palvere                 4025</code></pre>
<p>Selleks, et protokollide andmeid kaardil kuvada, ühendame <a href="https://geoportaal.maaamet.ee/docs/haldus_asustus/maakond_shp.zip?t=20201001005508">Maa-ameti maakonnapiiride andmed</a> vallakohtute andmetega.<br />
Esmalt laadime mõlemad andmestikud QGISi.</p>
<ul>
<li>Maa-ameti andmed laadime vektorkihina: <em>Layer</em> -&gt; <em>Add Layer</em> -&gt; <em>Add Vector Layer</em> -&gt; [vali SHP-fail] -&gt; <em>Add</em> -&gt; <em>Close</em><br />
</li>
<li>Vallakohtute andmed laadime csv-kihina: <em>Layer</em> -&gt; <em>Add Layer</em> -&gt; <em>Add Delimited Text Layer</em> -&gt; [vali fail <em>vallakohtud_RA.csv</em>] -&gt; tulpade eraldaja on tabulaator (<em>Tab</em>), linnuke on kastide ees <em>First record has field names</em> ja <em>Detect field types</em>, <em>Geometry Definition</em> on <em>No geometry</em> -&gt; Add -&gt; Close</li>
</ul>
<p>Selleks, et tavalist andmestikku ruumiandmetega ühendada, peab kahel andmestikul olema vähemalt üks ühine tunnus (näiteks tulp maakonnanimedega). <strong>Millised on vallakohtute maakonnanimed ja millised Maa-ameti maakonnapiiride maakonnanimed?</strong> Vaatame atribuuttabelist.<br />
Asendame Maa-ameti maakonnapiiride atribuuttabelis maakonnanimed nii, et need ühtiksid vallakohtute andmetega (nt <em>Viljandi maakond</em> -&gt; <em>Viljandi</em>). Selleks lisame tabelisse uue tulba nagu eelmiselgi korral. Tee paremklikk maakonnapiiride kihil -&gt; <em>Properties</em> -&gt; <em>Fields</em> -&gt; <em>Field calculator</em> -&gt; <em>Create new field</em> ning kasutame <a href="https://et.wikipedia.org/wiki/Regulaaravaldis">regulaaravaldist</a>, mis kustutab pärast maakonnanime osa " maakond" (teisisõnu: asendab selle osa mitte millegagi). <code>\\s</code> märgib siin tühikut.</p>
<div class="figure" style="text-align: center"><span id="fig:regexpreplace"></span>
<img src="imgs/regex_replace.PNG" alt="Maakonnanimede asendamine regulaaravaldise abil" width="100%" />
<p class="caption">
Figure 1.1: Maakonnanimede asendamine regulaaravaldise abil
</p>
</div>
<p>Nüüd on meil tunnus <strong>MNIMI2</strong>, mille abil saame kaht andmestikku ühendada. Ühendamiseks on aga kaks viisi.</p>
<ul>
<li><strong>Esiteks võime ühendada csv-tabeli <em>shapefile</em>’iga</strong>. Sellisel juhul säilib <em>shapefile</em>’i struktuur, milles on 15 rida (iga maakonna kohta üks) ning csv-failist lisatakse igale reale ainult mingid keskmised näitajad. Võime siin näiteks ühendada <em>shapefile</em>’iga iga maakonna protokollide keskmise pikkuse tähemärkides.</li>
<li><strong>Teiseks võime ühendada <em>shapefile</em>’i ruumiinfo csv-tabeliga</strong>. Sellisel juhul säilib csv-faili struktuur, milles on üle 25 000 rea (iga protokolli kohta üks) ning iga rida saab juurde koordinaadid. Võime siin näiteks ühendada csv-failiga iga maakonna keskpunkti (<em>tsentroidi</em>) koordinaadid.</li>
</ul>
<div id="csv-info-ühendamine-shp-ga" class="section level3">
<h3><span class="header-section-number">1.1.1</span> CSV info ühendamine SHP-ga</h3>
<ul>
<li>Esmalt on meil vaja CSV-tabelist saada tabel, kus oleks iga maakonna kohta protokollide keskmine pikkus tähemärkides. Selleks saame luua näiteks uue virtuaalse kihi ning kasutada SQL-i päringut. Mine <em>Layer</em> -&gt; <em>Create Layer</em> -&gt; <em>New Virtual Layer</em>, nimeta kiht nt <em>keskmised</em>, <em>Embedded layers</em> saki alt vali <em>Import</em> ning impordi kiht <em>vallakohtud_RA</em>. Sisesta <em>Query</em> väljale pildil näidatud SQL-i päring ning vajuta <em>Add</em>.<br />

<div class="figure" style="text-align: center"><span id="fig:virtuallayer"></span>
<img src="imgs/virtuallayer.PNG" alt="Virtuaalse kihi loomine" width="100%" />
<p class="caption">
Figure 1.2: Virtuaalse kihi loomine
</p>
</div></li>
<li>Tee nüüd maakonna kihist duplikaat: paremklikk kihil -&gt; <em>Duplicate Layer</em>.<br />
</li>
<li>Kuna vallakohtute andmestikus on kahe Viru maakonna (Ida-Viru ja Lääne-Viru) asemel lihtsalt üks Virumaa, siis ühendame maakonna kihi duplikaadis Ida- ja Lääne-Viru polügoonid üheks. Selleks
<ul>
<li>tee duplikaadi kiht aktiivseks ning mine muutmise režiimi (<em>Edit</em>, vajuta kollasel pliiatsil);<br />
</li>
<li>vajuta valiku tööriista (<em>Select</em>) ning Ctrl-klahvi all hoides vali Ida- ja Lääne-Virumaa polügoonid;<br />
</li>
<li>vali menüüs <em>Edit</em> -&gt; <em>Merge selected polygons</em>, jälgi, et nii MNIMI kui ka MNIMI2 tulpadel oleks Id <em>Manual value</em> ning määra ühendatud kihile tulba <em>MNIMI</em> väärtuseks <em>Viru maakond</em> ning tulba <em>MNIMI2</em> väärtuseks <em>Viru</em>. Juhul, kui atribuuttabelisse jääb endiselt väärtus <em>Lääne-Viru</em> või <em>Ida-Viru</em>, muuda see käsitsi atribuuttabelis ära (muutmiseks vajuta atribuuttabelis kollasel pliiatsil ning muutmise lõpetamiseks uuesti kollasel pliiatsil). Lõplikus atribuuttabelis peaks olema ainult <em>Viru</em> ja <em>Viru maakond</em>.<br />

<div class="figure" style="text-align: center"><span id="fig:merge"></span>
<img src="imgs/merge_viru.PNG" alt="Virumaa polügoonide ühendamine" width="100%" />
<p class="caption">
Figure 1.3: Virumaa polügoonide ühendamine
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:merge2"></span>
<img src="imgs/edit_attributes.PNG" alt="Atribuuttabeli parandamine" width="100%" />
<p class="caption">
Figure 1.4: Atribuuttabeli parandamine
</p>
</div></li>
<li>Salvesta kihi muudatused (<em>Save layer edits</em>) ning välju muutmise režiimist (vajuta uuesti kollasel pliiatsil).<br />
</li>
</ul></li>
<li>Nüüd saame ühendada kihi <em>keskmised</em> ja maakonnapiiride kihi koopia. Selleks tee paremklikk maakonnapiiride kihi koopial -&gt; <em>Properties</em> -&gt; <em>Joins</em> -&gt; lisa rohelisest plussmärgist uus ühendamine, täida väljad nii nagu allpool oleval pildil ning vajuta <em>OK</em> ja uuesti <em>OK</em>.<br />

<div class="figure" style="text-align: center"><span id="fig:join1"></span>
<img src="imgs/join1.PNG" alt="Andmestike ühendamine (1)" width="70%" />
<p class="caption">
Figure 1.5: Andmestike ühendamine (1)
</p>
</div></li>
<li>Nüüd on meil maakonnapiiride kiht, mille atribuuttabelis on ka infot selle kohta, kui pikad vastava maakonna vallakohtuprotokollid keskmiselt on. Kasuta seda tulpa selleks, et värvida maakonnad eri tooni (pikemate protokollidega maakonnad tumedamalt, lühematega heledamalt). Selleks kasuta juba eelmistes praktikumides näidatud viise (<em>Symbology</em> -&gt; <em>Graduated</em> jne).<br />

<div class="figure" style="text-align: center"><span id="fig:join2"></span>
<img src="imgs/join2.PNG" alt="Ühendatud andmestikud" width="100%" />
<p class="caption">
Figure 1.6: Ühendatud andmestikud
</p>
</div></li>
</ul>
</div>
<div id="shp-info-ühendamine-csv-ga" class="section level3">
<h3><span class="header-section-number">1.1.2</span> SHP info ühendamine CSV-ga</h3>
<ul>
<li>Ühendame nüüd csv-failiga iga maakonna keskpunkti (<em>tsentroidi</em>) koordinaadid. Selleks tuleb meil esmalt leida maakondade polügoonide keskpunktid. Tee uus maakonnapiiride kihi koopia (duplikaat) ning nimeta see nt <em>maakonnad2</em> (paremklikk kihil -&gt; <em>Rename Layer</em>).</li>
<li>Tee kiht <em>maakonnad2</em> aktiivseks -&gt; <em>Vector</em> -&gt; <em>Geometry Tools</em> -&gt; <em>Centroids…</em> -&gt; jäta vaikeväärtused ning vajuta <em>Run</em>. Maakondade kihile ilmuvad nüüd uuel kihil polügoonide keskpunktid.<br />

<div class="figure" style="text-align: center"><span id="fig:centroids"></span>
<img src="imgs/centroids.PNG" alt="Polügoonide keskpunktide leidmine" width="100%" />
<p class="caption">
Figure 1.7: Polügoonide keskpunktide leidmine
</p>
</div></li>
<li>Järgmiseks lisame kihi <em>Centroids</em> atribuuttabelisse punktide <em>x</em>- ja <em>y</em>-koordinaadid: tee kiht aktiivseks -&gt; <em>Vector</em> -&gt; <em>Geometry Tools</em> -&gt; <em>Add Geometry Attributes</em>, jäta jällegi vaikeväärtused ning vajuta <em>Run</em> ja <em>Close</em>. Tekkis uus kiht <em>Added geom info</em>. Nimetame selle ümber nt <em>koord_keskpunktid</em>.<br />
</li>
<li>Ühendame nüüd CSV-kihi maakondade nimede järgi keskpunktide koordinaatide kihiga. Tee paremklikk kihil <em>vallakohtud_RA</em> -&gt; <em>Properties</em> -&gt; <em>Joins</em> -&gt; <em>Add new join</em><br />

<div class="figure" style="text-align: center"><span id="fig:join3"></span>
<img src="imgs/join3.PNG" alt="Andmestike ühendamine (2)" width="70%" />
<p class="caption">
Figure 1.8: Andmestike ühendamine (2)
</p>
</div></li>
<li>Salvestame kihi <em>vallakohtud_RA</em> uue CSV-failina (paremklikk -&gt; <em>Export</em> -&gt; <em>Save features as</em>). Jälgi, et kodeering oleks UTF-8, väljade eraldaja (<em>SEPARATOR</em>) oleks tabulaator ning koordinaatsüsteem EPSG:3301.<br />

<div class="figure" style="text-align: center"><span id="fig:savecsv"></span>
<img src="imgs/newcsv.PNG" alt="Koordinaatidega csv-faili salvestamine" width="70%" />
<p class="caption">
Figure 1.9: Koordinaatidega csv-faili salvestamine
</p>
</div></li>
<li>Nüüd loeme salvestatud faili uuesti csv-failina sisse nii, et määrame ära koordinaatide tulbad: <em>Layer</em> -&gt; <em>Add Layer</em> -&gt; <em>Add Delimited Text Layer</em>
<div class="figure" style="text-align: center"><span id="fig:readnewcsv"></span>
<img src="imgs/readnewcsv.PNG" alt="Koordinaatidega csv-faili sisselugemine" width="70%" />
<p class="caption">
Figure 1.10: Koordinaatidega csv-faili sisselugemine
</p>
</div></li>
<li>Nüüd on meil kaardil üksteise all igas maakonnas sadu ja tuhandeid punkte, ehkki vaikimisi näeme, et igas maakonnas on ainult üks punkt. Selleks, et protokollide jaotumist visuaalselt veidi paremini näidata, võime näiteks filtreerida välja ainult protokollid, mille teemaks on (ainult) “Sõim ja vägivald” ning teha <em>heatmap</em>’i.
<div class="figure" style="text-align: center"><span id="fig:heatmap"></span>
<img src="imgs/heatmap.PNG" alt="Heatmap" width="70%" />
<p class="caption">
Figure 1.11: Heatmap
</p>
</div></li>
</ul>
<p>Võid proovida teha sama kihelkondade andmetega, kasutades näiteks <a href="https://archive.org/download/HistoricalAdministrativeBordersOfEstonia/ee_admin_20thC_shapefiles.zip">siit</a> alla laaditavaid 1897. aasta kihelkonnapiiride andmeid. NB! Kihelkondade andmestikus on mõned polügoonid, mille ruumikuju on vigane ja millel seetõttu ei saa nende puhul näiteks keskpunkte leida. Selleks, et see segama ei hakkaks, määra QGISis <em>Settings</em> -&gt; <em>Options</em> -&gt; <em>Processing</em> -&gt; <em>General menu</em> -&gt; <em>Invalid features filtering</em> (= <em>Skip (ignore) invalid geometries</em>).</p>
</div>
</div>
<div id="geokodeerimine" class="section level2">
<h2><span class="header-section-number">1.2</span> Geokodeerimine</h2>
<p>Täpsemate asukohtade määramiseks (nt aadresside jaoks) saab kasutada geokodeerimise teenust. Geokodeerimine on aadressi või kohanime seostamine geograafiliste koordinaatidega. Tagurpidi geokodeerimine omakorda võimaldab koordinaatidest tuletada aadressid ja kohanimed.</p>
<p>Maa-amet pakub tasuta <a href="https://geoportaal.maaamet.ee/est/Teenused/Geokodeerimise-teenus-p440.html">geokodeerimise teenust</a>. Sealjuures on võimalik geokodeerida ainult üht aadressi/kohta korraga kui ka tervet hulka andmeid (massgeokodeerimine).</p>
<p><a href="https://inaadress.maaamet.ee/geocoder/one">Geokodeeri</a> alustuseks näiteks <strong>enda, oma sõbra, vanemate vt aadress</strong>. Saad väljundit kuvada nii aadressiobjektide kaardirakendused kui ka alla erinevates formaatides alla laadida. Kas jääd tulemuse täpsusega rahule?</p>
<p><a href="https://inaadress.maaamet.ee/geocoder/bulk"><strong>Massgeokodeerimise</strong></a> sisendiks sobivad CSV-, XLS- või XLSX-formaadis andmetabelid. CSV-formaadi puhul peab välju eraldama semikoolon. Vaatame seda lühikese näite abil, kus geokodeerime Tartu Ülikooli valdkondade ametlikud aadressid.</p>
<ul>
<li>Kodeerimisel pead ära määrama, millises tulbas paikneb lähteaadress, mida geokodeerima hakatakse. Antud juhul on selleks tulp <em>Aadress</em>.<br />
</li>
<li>Seejärel saad valida,
<ul>
<li>kas tahad aadresse lihtsalt normaliseerida (st viia kujule, milles need esinevad nt kohanimeregistris), ilma et saaksid aadressidele koordinaadid;</li>
<li>milliste objektide hulgast vasteid otsitakse. Meid huvitavad siin eeskätt õppehooned, aga veidi ebatäpsemate aadresside puhul (talud, tänavad, maakonnad, linnad jne) tasub otsida ka teiste objektide seast;<br />
</li>
<li>kas tahad, et andmeid töödeldaks sünkroonselt, mispuhul saad protsessi jälgida kohe samas veebilehitseja aknas, või asünkroonselt, mispuhul andmed laetakse serverisse ning kasutajale saadetakse mõne aja pärast tulemus meilile. Viimast tasub teha eeskätt siis, kui andmestik on mahukas.<br />
</li>
<li>milliseid ruumiandmete tulpasid väljundisse soovid (nt kas kõiki aadressiobjektide id-sid ja tasemeid);<br />
</li>
<li>kuidas vasteid esitatakse. Eeskätt puudutab see aadresse, millel on kas mitu vastet või millele täpset vastet ei leita.<br />

<div class="figure" style="text-align: center"><span id="fig:geocoding2"></span>
<img src="imgs/ut_geocoding.PNG" alt="Massgeokodeerimine (2)" width="100%" />
<p class="caption">
Figure 1.12: Massgeokodeerimine (2)
</p>
</div></li>
</ul></li>
</ul>
<p>Geokodeerimine töötab väga hästi tänapäevaste aadressidega.<br />
Vaatame aga nüüd ka natuke vanemaid andmeid, nimelt Rahvusarhiivi kaudu kasutatavat <strong>Tartu Ülikooli ja Eesti Ajalooarhiivi andmebaasi “Album Academicum 1918–1944”</strong>, mis koondab matrikliraamatutele jt allikatele tuginedes infot Tartu Ülikooli immatrikuleeritud üliõpilastest aastatel 1918-1944 (<a href="http://www.ra.ee/apps/andmed/index.php/site/page?view=aaut_annotation">vaata lähemalt</a>). Kuna andmestik ise on üpris mahukas, sisaldades infot enam kui 20 000 tudengi kohta, siis vaatame siin ainult kahe väga levinud perekonnanimega (Tamm ja Saar) üliõpilaste andmeid ning võrdleme nende perekonnanimedega üliõpilaste päritolu. Naisüliõpilaste andmete puhul ei pruugi võrdlus olla väga täpne, kuna andmestikus sisalduvad ka need kirjed, kus <em>Tamm</em> või <em>Saar</em> on saadud perekonnanimeks abiellumisel.<br />
Oleme veidi algandmestikku täiendanud ning lisanud standardiseeritud sünnikoha tulba, kus andmebaasis kajastatud sünnikohtadel on lühendid lahti kirjutatud ning erinevate tasemete vahele on lisatud komad.</p>
<pre><code>##   Matrikli.Nr.                Eesnimi Perenimi Isanimi Isa.tegevusala   Sünniaeg       Sünnikoht              Sünnikoht_std
## 1          120                  Alide     Tamm   Jakob      põllumees 20.01.1897 Võ Vana-Roosa v   Võrumaa, Vana-Roosa vald
## 2          129 Alexander (Aleksander)     Tamm    Jaan         Puudub 20.11.1896       Põltsamaa                  Põltsamaa
## 3          172                 Andres     Tamm    Hans      põllumees 22.09.1895  Vil Tarvastu v Viljandimaa, Tarvastu vald
## 4          207                    Ann     Tamm    Jaan      metsavaht 22.12.1890     Pä Karksi v      Pärnumaa, Karksi vald
## 5          407                 Alfred     Tamm    Jaan     majaomanik 10.12.1900           Valga                      Valga
## 6          513            Ado (Avdei)     Tamm   Juhan   mõisateenija 19.05.1893           Tartu                      Tartu
##         Surm Surmakoht              Kool                                                                       Eriala
## 1     Puudub    Puudub        Valga G 16                                                     med 19-24-, filos 24-26-
## 2       1933    Puudub    TÜ apt abil 21                                                                farm k 24-29*
## 3   Apr.1926    Puudub       Tartu RK 17                                    jur 17-, lood 17-, med 17-18-, med 19-23*
## 4     surnud     Eesti       Pärnu TG 10                                                                 filos 19-24-
## 5 12.07.1963       Tln       Tartu RK 18 keem 18-, keem 19-24-, jur 24-25-, New Yorgi Columbia Ü ajakirjandus 29..33*
## 6     surnud        Vn Tartu Al-dri G 13                                        mat 13-17-, mat 20..24*, kaub 24..27-
##           Akadeem..org. Teaduskraadide.omandamiseks.kaitstud.tööde.pealkirjad
## 1                Puudub                                                Puudub
## 2 Fraternitas Liviensis                                                Puudub
## 3                 Ugala                                                Puudub
## 4          EÜS Veljesto                                                Puudub
## 5                 Ugala                                                Puudub
## 6                   EÜS                                                Puudub
##                                                                                                                                                                                                                                                                                                                                                                                                                                          Elulugu
## 1                                                                                                                                                                                                                                                                                                                                                                                                                                         Puudub
## 2                                                                                                                                                                                                                                                                                                                                                                                                                                         Puudub
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                         Puudub
## 4                                                                                                     11-13 Võiera (Uue-Vändra v) algk, 13-16 Pärnu Eesti Kooliseltsi progümn-i õp, 16-18 tunniandja Pärnus. 18-19 Vahi põllutöökooli, 19-20 Tartu ÕSi, 20-21 Tartu Linna PRG, 22-30 Tartu linna õhtualgk õp. 22-45 TÜ filosoofiateaduskonna seminariraamatukogu korraldaja. 45 arret Tartus, 47 asumisel Salehardis, 50 vabanes, Eestis tagasi.
## 5 18-20 Vabadussõjas. 20 Tartu linnaraamatukogu ametnik. 25-35 elas USAs, kuukirja Meie Tee asutajaid ja toimetuse liige, tegi kaastööd Päevalehele ja ajakirjale Olion, 29 Estonian Bulletini toim. A-st 35 Eesti Kultuurkapitali kujutava kunsti sihtkapitali valitsuse sekretär ja ajakirja Välis-Eesti toim. Saksa okupatsiooni ajal ajalehe Eesti Sõna toimetuse liige. 49 küüditati Sõmeru vallast Krasnojarski kraisse, 57 Eestis tagasi.
## 6                                                                                                                                                                                                                                    17-20 Tartu linnavalitsuse ametnik, 22 opteerimiskomisjoni sekretär Moskvas. 22-32 kaubamaja K. Holst &amp; Ko ärijuht, 32-40 Shell Company of Estonia Ltd Tartu bensiinijaama juh. 41 arret, suri vangistuses.
##     pk
## 1 Tamm
## 2 Tamm
## 3 Tamm
## 4 Tamm
## 5 Tamm
## 6 Tamm</code></pre>
<p>Põhimõtteliselt võib proovida ka praktikumis tabelit <em>tamm_saar_koond2.csv</em> massgeokodeerimisse saata, ent kui teeme seda kõik koos, võib server saada üle koormatud. Seepärast oleme lisanud praktikumi materjalidesse ka juba geokodeeritud SHP-faili kaustas <em>RA_geokodeeritud</em>.</p>
<div class="figure" style="text-align: center"><span id="fig:geokod"></span>
<img src="imgs/geocoding_RA.PNG" alt="Massgeokodeerimine (RA)" width="90%" />
<p class="caption">
Figure 1.13: Massgeokodeerimine (RA)
</p>
</div>
<p><strong>Ülesanne</strong></p>
<ul>
<li><p>Laadi geokodeeritud andmestiku <em>shapefile</em> vektorkihina QGISi (NB! Arvesta kodeeringut valides, et tegemist on Maa-ameti failiga);</p></li>
<li><p>vali andmetele sobiv aluskaart;<br />
</p></li>
<li><p>värvi punktid selle järgi, kas tegemist on Tamme- või Saare-nimeliste üliõpilastega (tulp <em>pk</em>). Võid kasutada ka erinevaid sümboleid;</p></li>
<li><p>vii punktide läbipaistvus 30% peale;<br />
</p></li>
<li><p>vajadusel muuda aluskaart mustvalgeks.</p>
<div class="figure" style="text-align: center"><span id="fig:tammsaarmap"></span>
<img src="imgs/Tamm_Saar_map.PNG" alt="Tamme- ja Saare-nimeliste üliõpilaste sünnikohad Album Academicumis" width="100%" />
<p class="caption">
Figure 1.14: Tamme- ja Saare-nimeliste üliõpilaste sünnikohad Album Academicumis
</p>
</div></li>
</ul>
<p>Vaatame nüüd ka atribuuttabelit.<br />
Kuna tegemist on ajaloolise andmebaasiga, on paljud kohanimed vahepeal muutunud. Vaatame geokodeeritud tabelit ning püüame välja selgitada, milliste kohtadega on geokodeerijal probleeme olnud. Eeskätt aitab selle puhul puuduvate aadresside ridade tuvastamine ning sisend- ja täisaadressi tulpade võrdlus. Selleks liiguta atribuuttabelis aadressitulbad üksteise kõrvale.
Milliseid probleeme märkad?</p>
</div>
<div id="ruumiandmete-käsitsi-lisamine" class="section level2">
<h2><span class="header-section-number">1.3</span> Ruumiandmete käsitsi lisamine</h2>
<p>Alati ei anna automatiseeritud lahendused ja olemasolevad ruumiandmed piisavalt kvaliteetset tulemust. Sellisel juhul (näiteks ajalooliste andmestike puhul) tasub kasutada kohanimeandmebaase ja ajaloolisi kaarte aluskaartidena.</p>
<p>Vaatame näiteks Hageri vallakohtu protokolli aastast 1890. Protokollis on ära märgendatud ka nimeüksused, ent need ei ole tänapäevases kirjaviisis. Nimed sisalduvad failis <em>Harju_Hageri_Kohila_id4010_1890a_nimed.csv</em> olevas tabelis, ent võid võrdluseks kõrvale võtta lahti ka terve protokolli teksti (vastav txt-fail).</p>
<ul>
<li><p>Impordi andmed csv-failina QGISi (NB! tabelil ei ole tulbanimesid).<br />
</p></li>
<li><p>Filtreeri andmestikust välja ainult kohanimed (KO_koht).</p></li>
<li><p>Lisa Maa-ameti WMS/WMTS teenuse kaudu ajalooliste kaartide hulgast Schmiti-Rückeri aluskaart (XIX saj./1884), soovi korral ka mingi tänapäevane kaart.<br />
</p></li>
<li><p>Leia kaardilt võimalikult palju CSV-tabeli kohanimedest ning tee uus kiht, kuhu märgid vastavatesse kohtadesse punktid (<em>Layer</em> -&gt; <em>Create Layer</em> -&gt; <em>New shapefile layer</em>). Punktide märkimiseks tee loodud kiht aktiivseks ning vajuta kollasel pliiatsil, seejärel <em>Add Point Feature</em>.</p>
<div class="figure" style="text-align: center"><span id="fig:manual"></span>
<img src="imgs/manual.PNG" alt="1890. aasta Hageri vallakohtuprotokollis mainitud kohanimed" width="100%" />
<p class="caption">
Figure 1.15: 1890. aasta Hageri vallakohtuprotokollis mainitud kohanimed
</p>
</div></li>
</ul>
<p>Puuduvaid nimesid võid otsida ka näiteks <a href="https://www.eki.ee/knab/p_ee_et.htm">kohanimeandmebaasist</a> või <a href="https://xgis.maaamet.ee/xgis2/page/app/ajalooline">Maa-ameti ajalooliste kaartide kaardirakendusest</a>, mis võimaldab ka hõlpsat otsingut.</p>
</div>
<div id="järgmisel-korral" class="section level2">
<h2><span class="header-section-number">1.4</span> Järgmisel korral</h2>
<p>Neljapäeval tegeleme georefereerimisega.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
